import keyboard

# 1ï¸âƒ£ ç›£è½å–®éµæŒ‰ä¸‹
def ç›£è½æŒ‰ä¸‹(key: str, func):
    """
    ç›£è½å–®ä¸€æŒ‰éµã€ŒæŒ‰ä¸‹ã€äº‹ä»¶ã€‚

    åƒæ•¸:
        key (str): è¦ç›£è½çš„æŒ‰éµåç¨±ï¼Œä¾‹å¦‚ 'a' æˆ– 'space'
        func: æŒ‰ä¸‹å¾Œè¦åŸ·è¡Œçš„ function/method/lambda

    èªªæ˜:
        func(callback) çš„ç¬¬ä¸€å€‹åƒæ•¸æœƒæ˜¯ eventï¼Œä½†ä½ å¯ä½¿ç”¨ lambda _: çœç•¥ã€‚

    ç¯„ä¾‹:
        ç›£è½æŒ‰ä¸‹("a", lambda _: print("æŒ‰ä¸‹ A"))
    """
    keyboard.on_press_key(key, func)


# 2ï¸âƒ£ ç›£è½å–®éµæ”¾é–‹
def ç›£è½æ”¾é–‹(key: str, func):
    """
    ç›£è½å–®ä¸€æŒ‰éµã€Œæ”¾é–‹ã€äº‹ä»¶ã€‚

    åƒæ•¸:
        key (str): æŒ‰éµå
        func: æ”¾é–‹å¾Œè¦åŸ·è¡Œçš„ function/method/lambda

    ç¯„ä¾‹:
        ç›£è½æ”¾é–‹("a", lambda _: print("æ”¾é–‹ A"))
    """
    keyboard.on_release_key(key, func)


# 3ï¸âƒ£ ç›£è½ä»»æ„éµæŒ‰ä¸‹
def ç›£è½ä»»æ„éµ(func):
    """
    ç›£è½æ‰€æœ‰æŒ‰éµçš„æŒ‰ä¸‹äº‹ä»¶ã€‚

    åƒæ•¸:
        func: callback(event)
            event.name = è¢«æŒ‰ä¸‹çš„æŒ‰éµåç¨±

    ç¯„ä¾‹:
        ç›£è½ä»»æ„éµ(lambda e: print(e.name))
    """
    keyboard.on_press(func)


# 4ï¸âƒ£ ç›£è½ç†±éµï¼ˆå¦‚ ctrl+alt+aï¼‰
def ç›£è½ç†±éµ(çµ„åˆéµ: str, func):
    """
    è¨­å®šç†±éµï¼ˆhotkey listenerï¼‰ï¼ŒæŒ‰ä¸‹çµ„åˆéµæ™‚åŸ·è¡Œ funcã€‚

    åƒæ•¸:
        çµ„åˆéµ (str): ä¾‹å¦‚ 'ctrl+shift+a'
        func: ç†±éµè§¸ç™¼æ™‚åŸ·è¡Œçš„å‹•ä½œ

    å›å‚³:
        int: hotkey IDï¼Œå¯ç”¨æ–¼å–æ¶ˆç›£è½

    ç¯„ä¾‹:
        ç›£è½ç†±éµ("ctrl+shift+a", lambda: print("è§¸ç™¼"))
    """
    return keyboard.add_hotkey(çµ„åˆéµ, func)


# 5ï¸âƒ£ ç›£è½çµ„åˆéµï¼ˆåŒ add_hotkeyï¼‰
def ç›£è½çµ„åˆéµ(çµ„åˆéµ: str, func):
    """
    èˆ‡ç†±éµç›¸åŒï¼Œç”¨æ–¼ç›£è½å¤šéµçµ„åˆï¼Œä¾‹å¦‚ shift + aã€‚

    åƒæ•¸:
        çµ„åˆéµ (str)
        func: åŸ·è¡Œå‹•ä½œ

    å›å‚³:
        int: hook ID
    """
    return keyboard.add_hotkey(çµ„åˆéµ, func)


# 6ï¸âƒ£ è¨­å®šå¿«æ·éµï¼ˆå–®éµæˆ–çµ„åˆéµï¼‰
def è¨­å®šå¿«æ·éµ(æŒ‰éµ: str, func):
    """
    è¨­å®šå¿«æ·éµï¼ŒæŒ‰ä¸‹ç‰¹å®šæŒ‰éµæœƒåŸ·è¡Œ functionã€‚

    åƒæ•¸:
        æŒ‰éµ (str): æ”¯æ´ aã€bã€spaceã€ctrl+q ç­‰
        func: è¦åŸ·è¡Œçš„å‹•ä½œ

    å›å‚³:
        int: hotkey ID
    """
    return keyboard.add_hotkey(æŒ‰éµ, func)


# 7ï¸âƒ£ é˜»æ“‹æŒ‰éµï¼ˆè®“æŒ‰éµç„¡æ•ˆï¼‰
def é˜»æ“‹æŒ‰éµ(æŒ‰éµ: str):
    """
    é˜»æ“‹æŸæŒ‰éµï¼Œä½¿å…¶åœ¨ç³»çµ±ä¸­å®Œå…¨å¤±æ•ˆã€‚

    åƒæ•¸:
        æŒ‰éµ (str): è¦å°é–çš„æŒ‰éµ

    ç¯„ä¾‹:
        é˜»æ“‹æŒ‰éµ("a") â†’ A å®Œå…¨ä¸èƒ½æŒ‰
    """
    keyboard.block_key(æŒ‰éµ)


# 8ï¸âƒ£ æ¨¡æ“¬æŒ‰ä¸‹æŒ‰éµ
def æ¨¡æ“¬æŒ‰ä¸‹(æŒ‰éµ: str):
    """
    æ¨¡æ“¬æŒ‰ä¸‹æŸå€‹æŒ‰éµï¼ˆä¸æœƒè‡ªå‹•æ”¾é–‹ï¼‰ã€‚

    åƒæ•¸:
        æŒ‰éµ (str)

    ç¯„ä¾‹:
        æ¨¡æ“¬æŒ‰ä¸‹("a")
    """
    keyboard.press(æŒ‰éµ)


# 9ï¸âƒ£ æ¨¡æ“¬æ”¾é–‹æŒ‰éµ
def æ¨¡æ“¬æ”¾é–‹(æŒ‰éµ: str):
    """
    æ¨¡æ“¬æ”¾é–‹æŸæŒ‰éµã€‚

    åƒæ•¸:
        æŒ‰éµ (str)
    """
    keyboard.release(æŒ‰éµ)


# ğŸ”Ÿ æ¨¡æ“¬å–®æ¬¡æŒ‰éµï¼ˆæŒ‰ä¸‹ + æ”¾é–‹ï¼‰
def æ¨¡æ“¬é»æ“Š(æŒ‰éµ: str):
    """
    æ¨¡æ“¬ä¸€æ¬¡å®Œæ•´æŒ‰éµï¼ˆpress + releaseï¼‰ã€‚

    åƒæ•¸:
        æŒ‰éµ (str)
    """
    keyboard.send(æŒ‰éµ)


# 1ï¸âƒ£1ï¸âƒ£ æª¢æŸ¥æŒ‰éµæ˜¯å¦æ­£åœ¨è¢«æŒ‰ä½
def æ˜¯å¦æŒ‰ä½(æŒ‰éµ: str) -> bool:
    """
    å›å‚³æŸæŒ‰éµç›®å‰æ˜¯å¦è¢«æŒ‰ä½ã€‚

    åƒæ•¸:
        æŒ‰éµ (str)

    å›å‚³:
        bool: True è¡¨ç¤ºæœ‰æŒ‰ä½

    ç¯„ä¾‹:
        if æ˜¯å¦æŒ‰ä½("a"):
            print("A æ­£åœ¨è¢«æŒ‰ä½")
    """
    return keyboard.is_pressed(æŒ‰éµ)


# 1ï¸âƒ£2ï¸âƒ£ é•·æŒ‰è§¸ç™¼ï¼ˆæŒ‰ä½æœŸé–“é‡è¤‡è§¸ç™¼ï¼‰
def é•·æŒ‰è§¸ç™¼(æŒ‰éµ: str, func):
    """
    ç•¶æŒ‰éµè¢«æŒ‰ä½æ™‚ï¼ŒæœƒæŒçºŒè§¸ç™¼ funcã€‚

    åƒæ•¸:
        æŒ‰éµ (str)
        func: è¦é‡è¤‡å‘¼å«çš„ function

    åŸç†:
        æ¯æ¬¡æŒ‰ä¸‹æ™‚æª¢æŸ¥æ˜¯å¦ä»æŒ‰ä½ï¼Œè‹¥æœ‰å°±å‘¼å« func()
    """
    def wrapper():
        if keyboard.is_pressed(æŒ‰éµ):
            func()
    keyboard.on_press_key(æŒ‰éµ, lambda _: wrapper())


# 1ï¸âƒ£3ï¸âƒ£ å–æ¶ˆæŸç›£è½
def å–æ¶ˆç›£è½(hook_id: int):
    """
    å–æ¶ˆç‰¹å®š hotkey/ç›£è½ã€‚

    åƒæ•¸:
        hook_id (int): add_hotkey å›å‚³çš„ ID
    """
    keyboard.remove_hotkey(hook_id)


# 1ï¸âƒ£4ï¸âƒ£ åœæ­¢æ‰€æœ‰ç›£è½
def å…¨éƒ¨åœæ­¢ç›£è½():
    """
    ç§»é™¤æ‰€æœ‰ keyboard çš„ç›£è½äº‹ä»¶ã€‚
    """
    keyboard.unhook_all()


# 1ï¸âƒ£5ï¸âƒ£ éŒ„è£½éµç›¤äº‹ä»¶ï¼ˆMacro recorderï¼‰

